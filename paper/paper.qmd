---
title: "The Impact of Tax Policy Evolution on Economic Development and Income Inequality"
author: 
  - Amie Liu, Wanling Ma
thanks: "Code and data are available at: https://github.com/WanlingMa/Tax-Equity-in-Low-and-Middle-Income-Countries-Replication"
date: today
date-format: long
abstract: "First sentence. Second sentence. Third sentence. Fourth sentence."
format: pdf
number-sections: true
bibliography: references.bib
---

```{r}
#| include: false
#| warning: false
#| message: false

library(tidyverse)
library(palmerpenguins)
library(haven) # for reading .dta files
library(dplyr) # for data manipulation
library(ggplot2)
library(patchwork)
library(tidyr)
library(readr)
library(labelled)
```


# Introduction

You can and should cross-reference sections and sub-sections. We use @citeR and @rohan.

The remainder of this paper is structured as follows. @sec-data....


# Data {#sec-data}

## Source

The original paper, "Tax Equity in Low- and Middle-Income Countries," utilized for replication, was published in the American Economic Association journal in 2024 [@article]. It explores the role of taxation in mitigating income inequality within countries with lower and middle incomes [@article]. This paper seeks to build upon the findings of the original paper, using the same datasets that were last retrieved on February 10th, 2024. 

In this paper, we discuss how economic development influences tax structures, with a focus on the shift from indirect to personal income taxes as countries' economies grow, driven by an expanding formal sector and enhanced tax enforcement. Additionally, we examine how the prevalence of the informal sector affects tax progressivity, highlighting that indirect taxes like VAT can become progressive in environments with significant informality. Lastly, we explore the challenges faced in taxing high-income individuals in low- and middle-income countries, including evasion and enforcement limitations, which impede the effectiveness of direct taxes on the wealthy.

## Methodology

This paper used the R programming language [@citeR] and the 'tidyverse' [@citeTidyverse] packages for replication, reproduction, data cleaning, and analysis. Within the 'tidyverse' package [@citeTidyverse], we used 'readr' [@citeReadr], 'dplyr' [@citeDplyr], 'tidyr' [@citeTidyr], and 'ggplot2' [@citeGgplot2] for reading CSV files, manipulating data, tidying data, and creating graphs.

Data collection methods exhibit significant diversity among open sources. We conducted a data-cleaning procedure for reproduction, focusing on variable selection, simplifying variable names, and removing missing values. The variables selected from the original paper were chosen based on their relevance to our research question, relating to (TODO). 

This paper analyzes the datasets listed below, which we have organized into three categories: Economic Development and Growth, Labor Market and Employment, and Taxation and Income Distribution.

```{r}
#| echo: false
#| warning: false
#| message: false


#### Pre-process data ####

target_year <- 2016

# Bring in Population and GDP, World Development Indicators World Bank
pop <- read_dta("../data/raw_data/gdp_population_WDI.dta") %>%
  filter(year == target_year) %>%
  select(-year)

# Bring in Oil and Gas Rich status countries from Ross-Mahdavi (2015)
oil <- read_dta("../data/raw_data/ross_mahdavi.dta") %>%
  filter(year == 2013) %>%
  rename(oil_pct_2013 = oil_pct) %>%
  select(country, oil_pct_2013)

# Bring in tax rates data
tax_rates <- read_dta("../data/raw_data/globalETR_bfjz.dta") %>%
  filter(year == target_year)

# Clean up tax_rates data for merge
tax_rates <- tax_rates %>%
  select(-year)

# Merge with population data
merged_data <- tax_rates %>%
  left_join(pop, by = c("country" = "country"))

# Keep only the rows that successfully merged
merged_data <- filter(merged_data, !is.na(pop))

# Merge with oil data
merged_data <- merged_data %>%
  left_join(oil, by = c("country" = "country"))

# Adding ISO codes
merged_data$iso3 <- merged_data$country

# Add income classification and continents from WB (country_frame)
country_frame <- read_dta("../data/raw_data/country_frame.dta")
merged_data <- left_join(merged_data, country_frame, by = c("iso3" = "iso3"))


# Apply 2 sample conditions: more than 1M inhabitants, less than 33% of GDP arises from oil and gas production
merged_data <- filter(merged_data, pop > 1000000) # Drop countries with <= 1M inhabitants

# Listing and dropping countries where oil and gas production is >= 33%
merged_data <- filter(merged_data, is.na(oil_pct_2013) | oil_pct_2013 < 0.33) # Drop oil and gas producers
merged_data <- rename(merged_data, country_name = "country_name.x", region = "region.x")
merged_data <- merged_data %>% select(-c("region.y", "country_name.y"))

merged_data <- merged_data %>%
  mutate(
    gdp_to_ndp = gdp_currentusd / ndp_usd
  )

# Updating variables from NDP ratios to GDP ratios
vars_to_update <- c("pct_tax", "pct_1100", "pct_1200", "pct_2000", "pct_4000", "pct_5000", "pct_6000")
for(var in vars_to_update) {
  merged_data[[var]] <- 100 * (merged_data[[var]] / merged_data$gdp_to_ndp)
}

merged_data <- merged_data %>%
  mutate(
    gdp_to_ndp = gdp_currentusd / ndp_usd,
    pct_tax_noSSC = pct_tax - pct_2000,
    pct_other_taxes = pct_1200 + pct_4000 + pct_6000,
    gdp_pc = gdp_currentusd / pop,
    ln_gdp_pc = log(gdp_pc),
    ndp_pc = ndp_usd / pop,
    ln_ndp_pc = log(ndp_pc)
  )

# Generate Gpct_tax_noSSC as pct_tax_noSSC divided by 100
merged_data <- merged_data %>%
  mutate(Gpct_tax_noSSC = pct_tax_noSSC / 100)

```

### Economic Development and Growth

`data/gdp_population_WDI.dta`

The dataset was obtained from the World Bank’s World Development Indicators @worldDevelopmentIndicators. It encompasses a comprehensive sample from 266 countries and spans from the year 1960 to 2020 [@worldDevelopmentIndicators]. Three key variables available within the database are GDP in 2010 USD (gdp_2010usd), GDP in current USD (gdp_currentusd), and Population (pop). GDP per capita (USD) is calculated as the ratio of gdp_2010usd to population, providing a measure of economic output per person adjusted for inflation [@worldDevelopmentIndicators]. Meanwhile, GDP per capita (current) is calculated by dividing gdp_currentusd by population, offering a snapshot of economic output per person in current currency values [@worldDevelopmentIndicators]. This enables researchers to analyze economic growth, trends, and developments over an extensive time across diverse geographical regions.

`data/ross_mahdavi.dta`

The dataset was obtained from the Harvard Dataverse @oilGasData. It encompasses information about oil and natural gas production of all countries from 1932 to 2014 [@oilGasData]. It contains six column variables, including the country ID (country), year, approximate value of oil and gas product in US dollars (natres_richesse), GDP worldwide (gdp_wid), GDP in constant 2014 US dollars (gdp_2014usd), and oil and gas product as percentage of GDP (oil_pct) [@oilGasData]. Covering the period from 1932 to 2014, this dataset provides a longitudinal perspective on oil and natural gas production trends with a global scope, providing valuable insights into the economic aspects of oil and natural gas production.

`data/globalETR_bfjz.dta`

The dataset was sourced from the paper titled “Globalization and Factor Income Taxation” [@incomeTaxation] and is accessible through the website associated with the paper [@incomeTaxationWebsite]. It provides data on economic indicators and taxation in each country from 1965 to 2018, including the net domestic product in constant 2019 US dollars, effective tax rate, tax revenue, total income tax, social contributions, property and wealth tax, and indirect tax [@incomeTaxationWebsite]. This allows the authors to comparatively analyze the effective tax rate and taxation policies that influence income distribution globally. 

`data/country_frame.dta`

The dataset was obtained from the World Bank’s World Development Indicators @incomeClassification. It includes several columns containing key indicators related to economic, social, and environmental development. These columns cover variables such as country codes represented by both two-letter (iso2) and three-letter (iso3), country names (country_name), region names (regionname), and income level classifications (incomelevelname) [@incomeClassification]. The income level classification consists of five distinct variables: high income, low income, upper middle income, lower middle income, and unclassified [@incomeClassification]. These variables provide insights into the economic, social, and environmental characteristics of countries worldwide.


### Labor Market and Employment

`data/API_SL.EMP.SELF.ZS_DS2_en_csv_v2_5560396.csv`

The dataset was sourced from the International Labour Organization @selfEmployedWorkforce and contains information from 1960 to 2022. It includes essential variables such as country code, country name, indicator name, indicator code, and the percentage of total employment each year [@selfEmployedWorkforce]. By focusing on self-employment as a specific indicator type, the dataset enables the analysis of the proportion of self-employed people among the total workforce across different countries and over time.


### Taxation and Income Distribution

`data/regressions_output_central.dta`
`data/Country_information.xlsx`

These regression datasets were obtained from the authors’ article “Informality, Consumption Taxes, and Redistribution” @informalConsumption. The column variables include a unique identifier for each country (country_code), the year in which the data was collected (year), the number of iterations performed during the regression analysis (iteration), regression coefficient (b), standard error of the regression coefficient (se), and the coefficient of determination (r2_adj) [@informalConsumption]. These were conducted for the regression analysis of informal shares in household consumption data. 


`data/PIT_parameters_AJ.dta`

The dataset originates from Jensen’s journal article “Employment Structure and the Rise of the Modern Tax System” @PITThresholds. It consists of data spanning from the year 1870 to 2014 and covers 100 countries. It includes several column variables, such as country code value (country_code), country name, year, mean of GDP per capita (lg_gdppc), mean of the marginal income tax rate (mtr), and mean of the size of personal income tax (size_pit) [@PITThresholds]. These variables delve into the relationship between country-level exemption threshold, tax system evolution, and economic development across different countries and times. 


`data/PIT_Top_Rates_2022.csv`

The dataset was collected and coded by the authors in 2023, providing information on the country-level top marginal tax rate of personal income tax for the year 2022 across various countries [@article]. This dataset provides insights into the taxation policies and structures related to personal income tax rates implemented by different countries in the specified year.

`data/PSPR_incidence_dirtax_2023.dta`

The dataset utilized in the World Bank Poverty and Shared Prosperity report Chapter 5 "Correcting Course" @directTaxation is sourced from the Commitment for Equity Institute and the World Bank. It was shared by the World Bank in response to the authors' request [@directTaxation]. The dataset encompasses various variables, including country and year of the CEQ project (ctry_year), country of the CEQ project (ctry_ceq), year of the CEQ project (year), the incidence of direct taxes across income deciles (in_pdi_dirtax), World Economic Outlook group classification (class_weo), and others [@directTaxation]. These variables show poverty, inequality, and shared prosperity metrics, enabling detailed analyses of economic and equity-related indicators across different countries and periods.



# Results

@fig-taxes-gdp visualizes the relationship between a country's level of economic development, as denoted by GDP per capita (constant 2010 US dollars, on a logarithmic scale with breaks at \$500, \$2000, \$10,000, and \$50,000), and the total share of GDP allocated to tax revenue, excluding social security contributions (SSC). This exclusion targets a focus on tax revenues more directly amenable to policy adjustments in the sphere of redistribution. The y-axis scale ranges from 0.0 to 0.5, indicating a span from no tax revenue to half of the GDP attributed to taxes.

Comprising data from 132 countries that satisfy the inclusion criteria of having a population above one million and deriving less than one-third of their GDP from oil and gas revenue, @fig-taxes-gdp broadly demonstrates a pattern where the share of GDP collected as tax revenue increases concomitantly with GDP per capita. This observation is visualized in a trend line, modeled via a LOESS regression (with a 95% confidence interval shaded in grey), which gently ascends from left to right, suggesting a positive correlation between economic development (GDP per capita) and the proportion of GDP collected through taxes.

The majority of countries’ data points cluster around the smoothed trend line, underscoring a general conformity to the depicted relationship. However, there are notable exceptions. A few outliers consist of countries with a relatively high GDP per capita (around \$30,000) yet almost negligible tax revenue shares. The presence of outliers suggests that while a positive correlation exists, the relationship is not without its exceptions. This variance underlines the complexity of tax system dynamics and the factors influencing tax collection beyond mere economic development.

```{r}
#| label: fig-taxes-gdp
#| fig-cap: Total Tax Revenue (excl. SSC)
#| echo: false
#| warning: false
#| message: false

ggplot(merged_data, aes(x = gdp_pc, y = Gpct_tax_noSSC)) +
  geom_point(color = "blue") +
  geom_smooth(method = "loess", color = "grey", formula = y ~ x, se = TRUE) + 
  scale_x_log10(labels = scales::label_dollar(), breaks = c(500, 2000, 10000, 50000)) +
  labs(
    x = "GDP per capita (Constant 2010 USD, log scale)",
    y = "Share of GDP"
  ) +
  theme_minimal() +
  theme(
    plot.background = element_blank(),
    panel.grid.minor = element_line(color = "grey", linetype = "dotted"),
    panel.grid.major.x = element_blank(),
    panel.grid.major.y = element_line(color = "grey", linetype = "dotted"),
    plot.subtitle = element_text(size = rel(1.2))
  )
```

```{r}
#| echo: false
#| warning: false
#| message: false

##### Mutate Data #####
vars <- c("pct_tax_noSSC", "pct_1100", "pct_5000", "pct_other_taxes", "pct_1200", "pct_4000", "pct_6000")

# Generating ratios
for (var in vars) {
  new_var_name <- paste0("r_", var)
  merged_data[[new_var_name]] <- merged_data[[var]] / merged_data$pct_tax_noSSC
}

plot_1 <- ggplot(merged_data, aes(x = gdp_pc, y = r_pct_5000)) +
  geom_point(color = "blue") +
  scale_x_log10(labels = scales::label_dollar(), breaks = c(500, 2000, 10000, 50000)) +
  labs(
    x = "GDP per capita (Constant 2010 USD, log scale)",
    y = "Share of Tax Revenue",
    subtitle = "Indirect Tax"
  ) +
  ylim(0, 1) + 
  theme_minimal() +
  theme(
    plot.background = element_blank(),
    plot.subtitle = element_text(size = rel(1.2))
  )
```

```{r}
#| echo: false
#| warning: false
#| message: false

plot_2 <- ggplot(merged_data, aes(x = gdp_pc, y = r_pct_1100)) +
  geom_point(color = "blue") +
  scale_x_log10(labels = scales::label_dollar(), breaks = c(500, 2000, 10000, 50000)) +
  labs(
    x = "GDP per capita (Constant 2010 USD, log scale)",
    y = "Share of Tax Revenue",
    subtitles = "Personal Income Tax"
  ) +
  ylim(0, 1) + 
  theme_minimal() +
  theme(
    plot.background = element_blank(),
    plot.subtitle = element_text(size = rel(1.2))
  )


```

```{r}
#| label: fig-taxrevenue-gdp-diff-source
#| fig-cap: Share of Tax Revenue from different sources
#| echo: false
#| warning: false
#| message: false
#| fig.height: 12
#| fig.width: 9

plot_3 <- ggplot(merged_data, aes(x = gdp_pc, y = r_pct_other_taxes)) +
  geom_point(color = "blue") +
  scale_x_log10(labels = scales::label_dollar(), breaks = c(500, 2000, 10000, 50000)) +
  labs(
    x = "GDP per capita (Constant 2010 USD, log scale)",
    y = "Share of Tax Revenue",
    subtitles = "All Other Taxes"
  ) +
  ylim(0, 1) + 
  theme_minimal() +
  theme(
    plot.background = element_blank(),
    plot.subtitle = element_text(size = rel(1.2))
  )

combined_plot <- plot_1 + plot_2 + plot_3 + plot_layout(nrow = 3)
combined_plot


# Store merged dataset to proc/ for the following figures
write_dta(merged_data, "../data/proc/tax_sample.dta")
```

The first graph of @fig-taxrevenue-gdp-diff-source reveals a gradually declining trend in the share of tax revenue derived from indirect taxes, such as the value-added tax, sales taxes, excises, and tariffs, as a country's GDP per capita increases. This depiction underscores a noteworthy pattern wherein the reliance on indirect taxation decreases with economic advancement. The x-axis, representing GDP per capita, maintains the same log scale as in @fig-taxes-gdp, spanning from \$500 to \$50,000, while the y-axis scales from 0 to 1, indicating the proportion of total tax revenue attributed to indirect taxes. The uniformly gentle downward trajectory highlights a shifting tax structure in which nations with a lower GDP per capita have a higher propensity to lean on indirect taxes, a practice that progressively diminishes in favor of other tax forms as economies grow and develop.

Conversely, the second graph of @fig-taxrevenue-gdp-diff-source presents a slight but consistently upward trend, suggesting that the share of personal income tax in total tax revenue tends to increase with a country's economic development. This pattern aligns with the transition observed in more developed economies, where direct taxation, particularly on personal income, becomes a more significant contributor to the tax base, reflecting a move towards more progressive taxation policies. In contrast, the third graph of @fig-taxrevenue-gdp-diff-source exhibits a flat trend, indicating that the aggregate contribution of corporate income taxes, property, and wealth taxes to total tax revenue remains relatively stable across different levels of GDP per capita. Without the inclusion of confidence intervals in these panels, the clean, unobstructed trends in each graph offer a clear perspective on how the composition of tax revenue evolves with economic maturity, reinforcing the dynamic nature of tax systems and their responsiveness to broader economic contexts.

```{r}
#| echo: false
#| warning: false
#| message: false

source("../scripts/100-replications-figure2.R")
```

```{r}
#| label: fig-informality-selfemployment
#| fig-cap: Self Employment
#| echo: false
#| warning: false
#| message: false

print(plot1)
```

```{r}
#| label: fig-informality-consumption
#| fig-cap: Consumption in Traditional Stores
#| echo: false
#| warning: false
#| message: false

print(plot2)
```

@fig-informality-selfemployment and @fig-informality-consumption articulately illustrates the inverse relationship between economic development and the prevalence of informal economic activities, utilizing GDP per capita as a consistent measure of economic development across both figures. In @fig-informality-selfemployment, a markedly steep downward trend is shown. The graph delineates the share of self-employment within the active workforce—a proxy indicator for informality in labor—plummeting as the GDP per capita increases. With the x-axis mirroring the range of GDP per capita found in @fig-taxes-gdp, and the y-axis proportionately scaling from 0 to 1 to represent the share of employment, the visualization clearly communicates a significant decrease in self-employment ratios, moving from low-income to high-income countries. This correlation underscores the observation that the formalization of labor concomitantly rises with economic prosperity, highlighting a transition from self-employed to formally employed work statuses as nations advance economically.

Similarly, @fig-informality-consumption exhibits an equally steep downward trajectory, mapping the share of total consumption allocated towards traditional retail outlets—such as street stalls, public markets, and corner stores—against GDP per capita. This axis configuration adheres to the same range as @fig-taxes-gdp, facilitating a direct comparison of informality trends across different dimensions of the economy. The decline from almost universal reliance on informal retail in low-income countries, denoted by a share approaching 1, to a minimal percentage in high-income countries, reaching down to 0.12, starkly exemplifies the diminishing role of informal consumption channels with advancing economic maturity. The parallel between the steep decline in both informal labor and consumption vividly encapsulates the broader economic transition from informality to formality, reinforcing the theme that economic growth aligns with a decreasing share of the informal sector within the economy.

@fig-avg-tax-rate-vs-income-decile provides insights into how the average effective income tax rates vary across income deciles within 74 countries of varying income levels in 2022. These countries were selected based on the availability of fiscal incidence reports, with 30 categorized as high-income countries, 21 as upper-middle-income countries, and 23 as lower-income countries based on the World Bank [@article]. It highlights two main findings, which are higher average tax rates in higher income countries and the progressivity of income tax rates. We see that the average tax rates for income taxes are higher in high-income countries compared to low- and middle-income countries across all deciles. Specifically, the average tax rate for the highest income level (10th decile) in high-income countries exceeds 20%, while it remains below 10% for both upper-middle and lower-income countries (see @fig-avg-tax-rate-vs-income-decile). Similarly, the average tax rate for the lowest income level (1st decile) surpasses 5% in high-income countries but remains below 5% in lower-income and middle-income countries. 

Additionally, the figure illustrates the progressive nature of income tax rates, particularly in high-income countries. Within these countries, the average tax rates increase significantly across income deciles, from the 1st decile to the 10th decile of income distribution. While the households in the 10th decile in high-income countries bear more than 20% tax burden, the corresponding figures for low- and middle-income countries are 6% and 8% respectively (see @fig-avg-tax-rate-vs-income-decile). This observation indicates the progressive structure of the income tax system, where households with higher incomes contribute a larger proportion of their income in taxes compared to those with lower incomes. These findings underscore the differences in average income tax rates between different income levels and deciles, which clarifies the progressive nature of income tax systems in high-income countries and emphasizes the importance of considering the level of economic development in the design of tax policies.


```{r}
#| echo: false
#| warning: false
#| message: false

# Define the usual suspects (assuming this is a vector of variable names)
usualsuspects <- c("source", "class_pspr", "oecd", "ctry_year", "ctry_ceq", "year", "ctry", "ctry_code", "class_geo", "class_inc", "class_inc_code", "class_pspr", "class_pspr_code", "class_lend", "class_weo", "decile", "decnum", "ctry_code", "pen_scenario")

# Load the data
data <- read_dta("../data/raw_data/PSPR_incidence_dirtax_2023.dta")

# Keep the usual suspects and variables with 'in_*_dirtax'
data <- data %>%
  select(all_of(usualsuspects), starts_with("in_"), ends_with("_dirtax"))

# Replace class_inc values
data$class_inc <- ifelse(data$class_inc == "lic", "lmic", data$class_inc)


# Further data manipulation
data <- data %>%
  select(matches(".*_pdi.*"), matches(".*_pgt.*"), all_of(usualsuspects)) %>%
  arrange(ctry, year, decnum) %>%
  mutate(across(matches(".*_pdi.*"), ~.x * 100, .names = "pdi_var"),
         across(matches(".*_pgt.*"), ~.x * 100, .names = "pgt_var")) %>%
  mutate(varofint = ifelse(is.na(pdi_var), abs(pgt_var), abs(pdi_var))) %>%
  select(-matches(".*_pdi.*"), -matches(".*_pgt.*"), -matches("^ie_flag_p.*"))

# For countries with more than one project, pick the last one
data <- data %>%
  group_by(ctry) %>%
  mutate(yearmax = max(year, na.rm = TRUE),
         yearmax_av = mean(yearmax, na.rm = TRUE)) %>%
  ungroup() %>%
  filter(year == yearmax) %>%
  select(-yearmax, -yearmax_av)

# Collapse the dataset to summary statistics
# Assuming 'reportstat' is "median" and 'classificvariable' is "class_inc" as per your context
data_collapsed <- data %>%
  group_by(!!sym("class_inc"), decnum) %>%
  summarise(varofint = median(varofint, na.rm = TRUE), # Calculate median of varofint
            count = n()) %>%
  ungroup()

# Labeling variables (R doesn't use variable labels in the same way as Stata, but for documentation)
# You can store metadata or use attributes in R for a similar purpose
attr(data_collapsed$varofint, "label") <- paste("median", "dirtax", sep = "-")

# Reordering variables (dplyr automatically orders variables based on the group_by and summarise steps)
# If you need to explicitly change the order, you can use select()
data_collapsed <- data_collapsed %>%
  select(class_inc, !!sym("class_inc"), decnum, varofint, count)

# Drop observations where decnum == 11
data_collapsed <- data_collapsed %>%
  filter(decnum != 11)

data <- data_collapsed
```

```{r}
#| label: fig-avg-tax-rate-vs-income-decile
#| fig-cap: De-Facto Distributional Incidence of Direct Taxes
#| echo: false
#| warning: false
#| message: false

ggplot(data, aes(x = decnum, y = varofint, color = class_inc)) +
  geom_line(aes(linetype = class_inc)) + # Use different linetypes for each class_inc
  geom_point(aes(shape = class_inc)) + # Use different shapes for each class_inc
  scale_color_manual(values = c("hic" = "forestgreen", "lmic" = "sienna", "umic" = "purple")) +
  labs(x = "Income Decile (within country)", 
       y = "Average Tax Rate") +
  theme_minimal() +
  theme(plot.background = element_blank(),
        panel.background = element_blank(),
        legend.position = "none") +
  annotate("text", x = 7.3, y = 18.5, label = "High Income", color = "forestgreen") +
  annotate("text", x = 7.2, y = 7.8, label = "Upper-Middle Income", color = "purple") +
  annotate("text", x = 8.5, y = 1, label = "Lower Income", color = "sienna")
```

```{r}
#| echo: FALSE
#| warning: FALSE
#| message: FALSE

# Load data on breadth of tax base
data_pit_parameters <- read_dta("../data/raw_data/PIT_parameters_AJ.dta")

# Calculate max year by country and filter
data_pit_parameters <- data_pit_parameters %>%
  group_by(country) %>%
  filter(year == max(year)) %>%
  ungroup()

# Rename variables and keep specific columns
data_pit_parameters <- data_pit_parameters %>%
  rename(iso2 = country_code) %>%
  select(iso2, lg_gdppc, size_pit)

# Save the intermediate data frame
threshold <- tempfile()
write_dta(data_pit_parameters, threshold)

# Load data on top Marginal Tax Rates
data_top_rates <- read_csv("../data/raw_data/PIT_Top_Rates_2022.csv")

# Convert top_rate to numeric and handle exceptions
data_top_rates$top_rate <- as.numeric(data_top_rates$top_rate)
data_top_rates <- data_top_rates %>%
  rename(iso2 = alpha_2) %>%
  filter(iso2 != "CI") %>%
  select(iso2, top_rate)

# Save the intermediate data frame
PIT_rates <- tempfile()
write_dta(data_top_rates, PIT_rates)

# Load complete sample data
complete_sample_data <- read_dta("../data/proc/complete_sample_data.dta")
complete_sample_data <- complete_sample_data %>%
  filter(sample_only_informal_csption != 1) %>%
  select(-sample_only_informal_csption)

# Merge with PIT rates
complete_sample_data <- complete_sample_data %>%
  left_join(data_top_rates, by = "iso2") %>%
  filter(!is.na(top_rate))

# Merge with threshold data
complete_sample_data <- complete_sample_data %>%
  left_join(data_pit_parameters, by = "iso2") %>%
  mutate(threshold_only = ifelse(is.na(size_pit), 0, 1))

# Generate income_groups based on incomelevelname
complete_sample_data$income_groups <- case_when(
  complete_sample_data$incomelevelname == "Low income" ~ 1,
  complete_sample_data$incomelevelname == "Lower middle income" ~ 2,
  complete_sample_data$incomelevelname == "Upper middle income" ~ 3,
  complete_sample_data$incomelevelname == "High income" ~ 4,
  TRUE ~ NA_integer_
)

# Convert income_groups to a factor with labels for better readability
complete_sample_data$income_groups <- factor(complete_sample_data$income_groups, 
                                             levels = c(1, 2, 3, 4),
                                             labels = c("Low income", "Lower middle income", "Upper middle income", "High income"))

# Assuming 'data' is your data frame containing 'top_rate', 'gdp_pc', and 'lg_gdppc'
data <- complete_sample_data
# Create a new variable for color coding based on GDP per capita thresholds
data$color_group <- with(data, ifelse(gdp_pc >= 13000, "High GDP",
                                      ifelse(gdp_pc < 13000 & gdp_pc >= 4000, "Medium GDP", "Low GDP")))

```

```{r}
#| label: fig-statutory-tax-rate-vs-gdp-level
#| fig-cap: Top Statutory Tax Rate of Personal Income Tax
#| echo: false
#| warning: false
#| message: false 

ggplot(data, aes(x = gdp_pc, y = top_rate)) +
  geom_point(aes(color = color_group, shape = color_group)) +
  scale_x_log10(labels = scales::comma, breaks = c(500, 1000, 2000, 5000, 10000, 25000, 50000)) +
  scale_color_manual(values = c("High GDP" = "forestgreen", "Medium GDP" = "purple", "Low GDP" = "sienna")) +
  scale_shape_manual(values = c("High GDP" = 15, "Medium GDP" = 18, "Low GDP" = 17)) +
  labs(x = "GDP per capita (Constant 2010 USD, log scale)", y = "Tax Rate") +
  theme_minimal() +
  theme(legend.position = "none",
        plot.background = element_blank(),
        panel.background = element_blank())
```

@fig-statutory-tax-rate-vs-gdp-level shows the top statutory tax rate of the personal income tax across 129 countries, utilizing data from 2023 collected by the authors [@article] and particularly distinguishing between high-income countries and low- and middle-income countries. On average, the top statutory tax rate in high-income countries is marginally higher, standing at 35%, compared to 29% in low- and middle-income countries (see @fig-statutory-tax-rate-vs-gdp-level). Despite the slight variation in top statutory tax rates,  @fig-statutory-tax-rate-vs-gdp-level does not reflect a proportional relationship between GDP per capita and the top statutory tax rate. This underscores the nuanced dynamics of personal income taxation across different income levels and economic contexts.

@fig-workforce-share-vs-gdp-level shows the share of the active workforce subject to personal income tax across varying levels of economic development, as indicated by GDP per capita. It encompasses 92 countries and underscores the evolution of personal income taxation policies from lower-income to high-income countries [@article]. It reveals a distinct trend: as economic development progresses, there is a gradual increase in the share of the workforce subject to personal income tax obligations (see @fig-workforce-share-vs-gdp-level). In lower-income countries, the coverage of the personal income tax is minimal, with the lowest point hovering slightly above 0 share of the workforce and slightly over 500 GDP per capita. Conversely, high-income countries demonstrate a significantly higher share of the workforce population legally liable to pay personal income taxes, with the highest point approaching nearly 100 share of the workforce and exceeding 50,000 GDP per capita (see @fig-workforce-share-vs-gdp-level). These key findings highlight the differences in the implementation and coverage of personal income taxation policies between high-income and low- and middle-income countries, showing the evolution of tax systems across varying levels of economic development.

```{r}
#| label: fig-workforce-share-vs-gdp-level
#| fig-cap: Share of Workforce Legally Subject to Personal Income Tax
#| echo: false
#| warning: false
#| message: false 
#| 
data$gdppc <- exp(data$lg_gdppc)

ggplot(data, aes(x = gdppc, y = size_pit)) +
  geom_point(aes(color = color_group, shape = color_group)) +
  geom_smooth(method = "loess", color = "grey", formula = y ~ x, se = TRUE) + 
  scale_x_log10(labels = scales::comma, breaks = c(500, 1000, 2000, 5000, 10000, 25000, 50000)) +
  scale_color_manual(values = c("High GDP" = "forestgreen", "Medium GDP" = "purple", "Low GDP" = "sienna")) +
  scale_shape_manual(values = c("High GDP" = 15, "Medium GDP" = 18, "Low GDP" = 17)) +
  labs(x = "GDP per capita (Constant 2010 USD, log scale)", y = "Share of Workforce",
       subtitle = "Share of Workforce Legally Subject to Personal Income Tax") +
  theme_minimal() +
  theme(legend.position = "none",
        plot.background = element_blank(),
        panel.background = element_blank())
```

# Discussion

This paper expands upon the analysis presented in "Tax Equity in Low- and Middle-Income Countries" by Bachas, Jensen, and Gadenne @article, focusing on how economic growth shapes tax systems and influences tax equity. By examining the transition from indirect taxation, such as VAT, to direct taxation, including personal income taxes, as economies develop, this research provides insights into the mechanisms through which tax systems evolve and their implications for income inequality.

## Economic Development and the Evolution of Tax Structures: Findings and Implications

The key findings of our work underscore several important aspects of tax policy and its relationship with economic development:

1. Shift from Indirect to Direct Taxation: Our analysis, supported by data visualization in @fig-taxes-gdp and @fig-taxrevenue-gdp-diff-source, illustrates a clear trend of countries moving towards a greater reliance on direct taxes as their GDP per capita increases. This shift signifies a crucial step towards more progressive tax systems that can potentially reduce income inequality by placing a larger tax burden on those with higher incomes.

2. Role of the Informal Sector: The paper highlights the complex role of the informal sector in tax progressivity. Contrary to the conventional view that indirect taxes are regressive, our findings suggest that in economies with a significant informal sector, indirect taxes like VAT can exhibit progressive features. This observation, depicted in the nuanced analysis in @fig-taxrevenue-gdp-diff-source, challenges traditional tax policy narratives and emphasizes the need for a more context-specific approach to tax policy design.

3. Challenges in Taxing High-Income Individuals: @fig-statutory-tax-rate-vs-gdp-level and @fig-workforce-share-vs-gdp-level shows the difficulties encountered in effectively taxing high-income earners in low- and middle-income countries. Issues of tax evasion and enforcement challenges are major barriers to the effectiveness of direct taxes on the wealthy. These challenges are critical for understanding the limitations of current tax systems in achieving equity, as shown in our detailed examination of tax policy implications across various economies.

A more detailed discussion on each finding will be provided in the following sections.

## Shift from Indirect to Direct Taxation

The dynamics of tax policy are fundamentally intertwined with economic development, influencing not only fiscal stability but also social equity within nations. Taxation, encompassing both direct and indirect levies, serves as a crucial mechanism for redistributing income, funding public services, and shaping economic incentives. The relationship between tax structures and economic growth has been a subject of extensive study, revealing a nuanced interplay that varies significantly across different stages of economic development.

A pivotal aspect of this relationship is the observed shift from indirect to direct taxation as economies mature. Indirect taxes, such as sales taxes or VAT, are applied uniformly to transactions irrespective of the buyer's income level, potentially placing a disproportionate burden on lower-income households. Conversely, direct taxes, including personal and corporate income taxes, can be more effectively tailored to the payer's ability to pay, allowing for a more progressive taxation system. This shift not only reflects a country's evolving economic landscape but also its commitment to fostering social equity through tax policy.

### Empirical Evidence and Global Comparisons

The empirical evidence from @fig-taxes-gdp and @fig-taxrevenue-gdp-diff-source in the study vividly illustrates the transition from indirect to direct taxation as economies advance. This shift is evidenced by the positive correlation between GDP per capita and the share of GDP collected through direct taxes, excluding social security contributions. The data showcases a clear trend: as countries' economies develop, there's a marked decrease in the reliance on indirect taxes such as VAT, sales taxes, and excises, with a concurrent uptick in direct taxes, particularly personal income taxes. This pattern suggests a move towards more progressive tax systems in higher GDP per capita economies, where tax policies increasingly lean on direct taxation mechanisms to foster equitable economic growth and redistribution.

This observation aligns with global trends noted in academic literature. For instance, Genschel and Seelkopf's @genschel2016tax research on taxation trends outside the OECD reveals that while non-Western countries adopt Western tax trends like increasing general revenues and implementing consumption taxes, they struggle with establishing a strong, progressive personal income tax system. This struggle is attributed to various socio-economic and structural factors, which, despite global influences, hinder the replication of progressive tax regimes seen in more developed economies.

Moreover, Stoilova and Patonov @stoilova2013empirical provide a comprehensive analysis on the impact of taxation on economic growth within the European Union, offering empirical evidence of how tax structures affect economic performance from 1995 to 2010. Their findings, alongside the examination of tax revenue trends and social contributions in European Union countries by Dubrovina et al. @dubrovina2019nexus, underscore the significance of adapting tax policies to enhance fiscal roles and ensure equitable distribution without overburdening the population.

These studies corroborate the trends depicted in the provided figures, reinforcing the global narrative of evolving tax structures as economies grow. They not only validate the empirical evidence from the study but also expand the understanding of how these trends manifest in different contexts, from OECD countries to emerging economies. Such analyses underscore the complexity and dynamism of tax policy evolution, reflecting a broad consensus on the direction of tax policy reforms aimed at fostering economic development and social equity.

### Tax Policy's Impact on Income Inequality

The shift towards direct taxation, as economies grow, has potential implications for reducing income inequality, as evidenced by @fig-avg-tax-rate-vs-income-decile. These shifts suggest that as countries' GDP per capita increases, there's a greater reliance on progressive taxation mechanisms, which are known for their potential to reduce income disparities by imposing a larger tax burden on higher-income earners.

Literature supports this potential, with studies highlighting the role of tax policy in addressing income inequality. Ballard-Rosa, Martin, and Scheve @ballardrosa2017structure delve into the political economy aspects, suggesting that preferences over taxation significantly influence policy responses to income inequality. Moreover, Możdżierz @mozdzierz2015financialisation identifies financialization as a primary driver of increasing income inequality, indicating the need for tax policies that can counteract these trends effectively.

Further, research by Liu Qiongzhi highlights the decisive role of policy bias in determining fiscal redistribution policies, emphasizing the importance of favoring equitable tax rates and transfer payments to address income disparities [@liu2020policybias]. Khan and Padda @khan2021taxexpenditures find that in South Asia, taxation and social expenditure policies effectively reduce income inequality, highlighting the effectiveness of direct taxes and higher social spending as tools for income redistribution.

The complexity and challenges in designing effective tax policies are underscored by outliers in data, suggesting that not all shifts towards direct taxation seamlessly lead to reduced income inequality. Factors such as tax evasion and the informal economy pose significant challenges. Studies like Esaku's @esaku2021incomeinequality demonstrate how income inequality can exacerbate the size of the shadow economy, further complicating tax policy design and implementation. Additionally, Wildowicz-Szumarska @wildowiczszumarska2022eu discusses the effectiveness of redistributive policies within the EU, indicating varied success across different welfare state models in tackling income inequality through tax policy.

## Informality and Taxation

The interplay between the informal sector and tax policy design is pivotal for economic frameworks, particularly in developing economies. @fig-informality-selfemployment and @fig-informality-consumption, showing a marked decline in informality with increased GDP per capita, underscores a critical transition phase for tax policy considerations. This visual evidence aligns with literature indicating that as economies grow, the informal sector's proportionate contribution to the economy tends to diminish, posing both challenges and opportunities for tax policy [@loayza2016informality]. Loayza's work explains how the shrinking of the informal sector as a result of economic development necessitates adaptable tax policies capable of accommodating this transition. Specifically, tax policy effectiveness hinges on recognizing the evolving tax base and ensuring that tax structures are responsive to the changing landscape of formal and informal economic activities.

The implications of these findings are profound. They suggest that policymakers must prioritize the integration of the informal sector into formal economic considerations, tailoring tax policies to be more inclusive and reflective of an economy's developmental stage. This approach not only enhances tax revenue potential but also supports the formalization of informal activities, contributing to broader economic development goals.

### Rethinking Tax Progressivity in Informal Economies

The relationship between economic development, tax revenue, and the progressivity of indirect taxes, such as VAT, undergoes a complex evolution in the presence of significant informal sectors. @fig-taxes-gdp and @fig-taxrevenue-gdp-diff-source serve as empirical backdrops, illustrating the increasing share of tax revenue in tandem with GDP per capita and the progressive nature of tax rates across income deciles, respectively. Contrary to the conventional wisdom that labels indirect taxes as regressive, recent literature presents a nuanced perspective, especially relevant for economies with substantial informal sectors.

Studies by Bird and Gendron @bird2007vat and Alm and Embaye @alm2013taxing challenge the traditional view, providing evidence that VAT and other indirect taxes can exhibit progressive characteristics in contexts where the informal sector plays a dominant role. Bird and Gendron emphasize that the perceived regressivity of VAT is not a given, suggesting that its impact varies significantly across different income groups and is influenced by the structure of the informal sector. Alm and Embaye further this argument by demonstrating that in economies where informal activities are prevalent, the consumption patterns and the tax-burden distribution across different segments of society render indirect taxes less regressive than commonly assumed.

These findings suggest a critical reevaluation of tax policy design in developing economies. They advocate for a nuanced understanding of tax progressivity, one that accounts for the informal sector's impact on consumption and income distribution. By recognizing the progressive potential of indirect taxes in such contexts, policymakers can better tailor tax systems to achieve equity and efficiency goals, even in economies where informal activities are significant.

This literature underscores the importance of context-specific tax policy design, arguing for a more sophisticated analysis that considers the intricate dynamics between formal and informal economies. It points towards the potential for indirect taxes to contribute positively to tax fairness and revenue mobilization efforts in developing countries, challenging entrenched narratives about tax progressivity.

### Dynamics of Indirect Tax Progressivity in Informal Settings

The progressivity of indirect taxes in economies with significant informal sectors is influenced by a myriad of factors, as the second graph of @fig-taxrevenue-gdp-diff-source subtly indicates. This graph, highlighting a shift in the tax structure with economic development, sets the stage for exploring the underlying mechanisms that may contribute to the progressivity of indirect taxes within informal economies. Literature focusing on consumption patterns, tax compliance, and the role of the informal sector provides a comprehensive understanding of these dynamics.

Bahl and Bird @bahl2008should and Ulyssea @ulyssea2018firms offer insights into how consumption patterns within informal sectors can affect the distributional impact of indirect taxes. Bahl and Bird argue that the informal sector's consumption preferences often lean towards goods and services that are either exempt from indirect taxes or are subject to lower rates, which can inadvertently lead to a progressive tax impact. Ulyssea's work complements this view by examining the compliance aspect, suggesting that lower compliance rates in the informal sector for indirect taxes can shift the tax burden towards formal sectors, thereby influencing the overall progressivity of the tax system.

Moreover, the role of the informal sector in the broader economy, as discussed by Jaramillo and Oliva @jaramillo2013taxing, sheds light on the complex interplay between informal activities and tax policy effectiveness. They suggest that the informal sector's adaptability and its interactions with formal economic structures can mediate the impact of indirect taxes on different income groups, contributing to an unintended progressivity in tax outcomes.

These studies collectively underscore the importance of considering the informal sector's unique characteristics when evaluating the progressivity of indirect taxes. They highlight the need for tax policies that are informed by the realities of consumption, compliance, and economic participation in informal settings, suggesting that a nuanced approach to tax design could harness these factors towards more equitable tax outcomes.

## Ethics and Biases

The datasets we used in this paper potentially generate ethical concerns and biases, particularly regarding the representation of the informal sector, marginalized populations, such as women, racial and ethnic minorities, low-income households, and individuals working in precarious employment conditions. The ethical concerns emerge from the potential exclusion or underrepresentation of these groups in the economic datasets like the World Bank’s World Development Indicators and labor market data from the International Labour Organization [@article]. This exclusion risks reinforcing systemic inequalities by formulating tax policies based on incomplete pictures of economic realities. Bird and Gendron @bird2007vat highlight the importance of considering the informal sector's impact on tax progressivity, suggesting that overlooking this aspect can lead to biased policy recommendations that fail to address the needs of a significant segment of the population.

Moreover, biases in data collection and analysis processes, as seen in the reliance on formal economic indicators, may not capture the nuanced effects of taxation on different income groups, particularly those within informal economies. The datasets may not fully account for the progressive potential of indirect taxes in environments with significant informality, potentially misrepresenting the tax burden on lower-income households. Grown and Valodia @grown2010taxation emphasize the need for tax policy analysis to include gender-disaggregated data and consider the socio-economic dynamics of informal work to mitigate biases and ensure equitable tax policy formulations.

Addressing these ethical concerns and biases needs a methodological shift towards more inclusive and comprehensive data collection and analysis strategies. Incorporating a broader spectrum of economic activities and demographic details can help capture the diverse impacts of tax policies across different segments of society. This approach aligns with Sen’s @sen1999development advocacy for equity-focused economic analysis, urging researchers to critically examine their methodologies to prevent the perpetuation of existing disparities. By embedding such considerations in tax policy research, scholars can contribute to developing more equitable and effective taxation systems that reflect the complexities of modern economies and foster inclusivity.

### Inclusivity and Representation in Tax Data
The challenge of inclusivity extends to the representation of diverse economic activities and demographic groups within tax data. Policies based on incomplete data risk perpetuating systemic inequities by failing to account for the full spectrum of economic behaviors and conditions (O'Hare, 2018). For instance, tax evasion and avoidance strategies, more accessible to affluent individuals and corporations, are not uniformly represented in tax compliance studies, potentially leading to skewed perceptions of tax fairness and effectiveness.

Ethical Research Practices
Ethical research practices demand a critical examination of these biases and the implementation of methodologies that ensure broad representation and equity in tax policy analysis. Researchers are called upon to adopt inclusive data collection methods, disaggregate data by gender, income, and other relevant demographic factors, and consciously address the systemic biases that may influence their findings (Sen, 1999).

In sum, ethical considerations in tax policy research underscore the importance of conscientious data collection, analysis, and interpretation. By acknowledging and addressing biases, researchers can contribute to the development of tax policies that promote equity and inclusivity across all sectors of society.

## Weaknesses and next steps

It is worthy to note that our work also uncovers several issues that warrant further investigation:

1. Data Limitations and Generalizability: One emerging issue is the limitation related to data availability and its impact on the generalizability of our findings. The reliance on formal sector data may not fully capture the dynamics in countries with large informal sectors, potentially skewing our understanding of tax progressivity.

2. Policy Implementation Challenges: While our analysis suggests pathways for more equitable tax systems, the practical challenges of implementing such changes in low- and middle-income countries remain a significant concern. The transition to more progressive tax systems requires not only political will but also enhancements in administrative capabilities and enforcement mechanisms.

3. Economic Diversification and Tax Policy: Our findings also prompt questions about how economic diversification affects tax policy choices. As countries develop, the shift in their economic base—from agriculture to industry and services—could have profound implications for tax policy design and effectiveness.

In conclusion, while our paper builds upon and extends the findings of Bachas, Jensen, and Gadenne (2024), it also highlights the complexity of tax policy in the context of economic development. The insights provided through our analysis of tax structures, the role of the informal sector, and the challenges of taxing high-income individuals offer valuable contributions to the ongoing discussion about how to design equitable and effective tax systems in low- and middle-income countries. Further research is needed to address the emergent issues and to refine our understanding of the optimal tax policy frameworks that can support equitable economic development.



\newpage


# References


